import{u as f,d as y,a as j,p as D}from"./pricelist-74136fb6.js";import{_ as u,o as a,c as r,a as t,g as c,v as n,i as b,d as _,l as g,M as k,r as v,t as w,F as M,e as $,f as p}from"./index-265b8786.js";const F={props:["item"],data(){return{orginalItem:null}},methods:{async updateItem(s){try{let e=await f(s)}catch(e){this.$emit("resetItemData",this.orginalItem),alert(e.data)}},async deleteItem(s){try{(await y(s)).data&&this.$emit("itemDeleted",s._id)}catch(e){console.log(e)}}},created(){this.item.dateFrom=new Date(this.item.dateFrom).toISOString().substring(0,10),this.item.dateTo=new Date(this.item.dateTo).toISOString().substring(0,10),this.orginalItem={...this.item}}},x={key:0,class:"col-12"},C={class:"col-lg-2 ps-lg-0"},T={class:"row g-0 align-items-center"},P=t("div",{class:"col-lg-auto col-4"},[t("div",{class:"d-lg-none"},"Datum od")],-1),S={class:"col"},V={class:"col-lg-2"},A={class:"row g-0 align-items-center"},q=t("div",{class:"col-lg-auto col-4"},[t("div",{class:"d-lg-none"},"Datum do")],-1),U={class:"col"},B={class:"col-lg-2"},z={class:"row g-0 align-items-center"},L=t("div",{class:"col-lg-auto col-4"},[t("div",{class:"d-lg-none"},"Cijena (€)")],-1),N={class:"col"},O={class:"col-lg-2 col-12 mt-lg-0 mt-2"},E={class:"d-flex justify-content-lg-start justify-content-end"},R=t("button",{class:"btn btn-primary btn-sm",type:"submit"},"Ažuriraj",-1);function Z(s,e,d,h,i,l){return d.item?(a(),r("div",x,[t("form",{onSubmit:e[4]||(e[4]=b(o=>l.updateItem(d.item),["prevent"])),class:"row align-items-center bg-ligh py- border-botto border-to border-dark"},[t("div",C,[t("div",T,[P,t("div",S,[c(t("input",{class:"form-control rounded-0 border-dark",required:"","onUpdate:modelValue":e[0]||(e[0]=o=>d.item.dateFrom=o),type:"date",name:"dateFrom",placeholder:"Datum od"},null,512),[[n,d.item.dateFrom]])])])]),t("div",V,[t("div",A,[q,t("div",U,[c(t("input",{class:"form-control rounded-0 border-dark",required:"","onUpdate:modelValue":e[1]||(e[1]=o=>d.item.dateTo=o),type:"date",name:"dateFrom",placeholder:"Datum do"},null,512),[[n,d.item.dateTo]])])])]),t("div",B,[t("div",z,[L,t("div",N,[c(t("input",{type:"number",name:"price",required:"",class:"form-control rounded-0 border-dark",step:"0.1","onUpdate:modelValue":e[2]||(e[2]=o=>d.item.price=o),id:""},null,512),[[n,d.item.price]])])])]),t("div",O,[t("div",E,[R,t("div",{class:"btn btn-warning btn-sm ms-3",onClick:e[3]||(e[3]=o=>l.deleteItem(d.item))},"Izbriši")])])],32)])):_("",!0)}const G=u(F,[["render",Z]]),H={props:["object_id"],data(){return{item:{dateFrom:null,dateTo:null,price:null,object_id:this.object_id}}},methods:{async addPricelistItem(){try{let s=await j(this.item);this.item.dateFrom=null,this.item.dateTo=null,this.item.price=null,this.$emit("itemAdded",s.data)}catch{}}}},J={class:"modal fade",id:"addPricelistItemModal",tabindex:"-1","aria-labelledby":"addPricelistItemModalLabel","aria-hidden":"true"},K={class:"modal-content"},Q=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"addPricelistItemModalLabel"},"Dodaj novu stavku cjenika"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),W={class:"modal-body"},X={class:"ps-2"},Y=g('<div class="col-12"><div class="row d-lg-flex d-none"><div class="col-4 ps-0">Datum od</div><div class="col-4">Datum do</div><div class="col-4">Cijena (€)</div></div></div>',1),tt={class:"row align-items-center bg-ligh py- border-botto border-to border-dark"},et={class:"col-lg-4 ps-lg-0"},st={class:"row g-0 align-items-center"},ot=t("div",{class:"col-lg-auto col-4"},[t("div",{class:"d-lg-none"},"Datum od")],-1),it={class:"col"},dt={class:"col-lg-4"},lt={class:"row g-0 align-items-center"},at=t("div",{class:"col-lg-auto col-4"},[t("div",{class:"d-lg-none"},"Datum do")],-1),rt={class:"col"},ct={class:"col-lg-4"},nt={class:"row g-0 align-items-center"},mt=t("div",{class:"col-lg-auto col-4"},[t("div",{class:"d-lg-none"},"Cijena (€)")],-1),_t={class:"col"},ut=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Zatvori"),t("button",{type:"submit",class:"btn btn-primary"},"Spremi izmjene")],-1);function ht(s,e,d,h,i,l){return a(),r("div",J,[t("form",{onSubmit:e[3]||(e[3]=b((...o)=>l.addPricelistItem&&l.addPricelistItem(...o),["prevent"])),class:"modal-dialog"},[t("div",K,[Q,t("div",W,[t("div",X,[Y,t("div",tt,[t("div",et,[t("div",st,[ot,t("div",it,[c(t("input",{class:"form-control rounded-0 border-dark",required:"","onUpdate:modelValue":e[0]||(e[0]=o=>i.item.dateFrom=o),type:"date",name:"dateFrom",placeholder:"Datum od"},null,512),[[n,i.item.dateFrom]])])])]),t("div",dt,[t("div",lt,[at,t("div",rt,[c(t("input",{class:"form-control rounded-0 border-dark",required:"","onUpdate:modelValue":e[1]||(e[1]=o=>i.item.dateTo=o),type:"date",name:"dateFrom",placeholder:"Datum do"},null,512),[[n,i.item.dateTo]])])])]),t("div",ct,[t("div",nt,[mt,t("div",_t,[c(t("input",{type:"number",required:"",name:"price",step:"0.1",placeholder:"Cijena (€)",class:"form-control rounded-0 border-dark","onUpdate:modelValue":e[2]||(e[2]=o=>i.item.price=o),id:""},null,512),[[n,i.item.price]])])])])])])]),ut])],32)])}const vt=u(H,[["render",ht]]),pt={props:["name"],components:{pricelist_item_card:G,addModal:vt},data(){return{pricelistItems:[],object:null,object_id:null,addItemModal:null}},async created(){this.object_id=this.$route.params._id;let s=await D(this.$route.params._id);this.pricelistItems=s.data,this.object=this.pricelistItems[0].object[0]},methods:{resetItem(s){this.pricelistItems.forEach((e,d)=>{e._id===s._id&&(this.pricelistItems[d]=s)})},openAddPricelistModal(){let s=this.$refs.addModal.$el;this.addItemModal=new k(s,{}),this.addItemModal.show()},removeItemFromDom(s){this.pricelistItems=this.pricelistItems.filter(e=>e._id!=s)},addItemToDom(s){this.pricelistItems.push(s),this.addItemModal.hide()}}},bt={class:"container"},gt={class:"my-4"},It={key:0},ft={key:1,class:"row gy-4"},yt=g('<div class="col-12"><div class="row d-lg-flex d-none"><div class="col-2">Datum od</div><div class="col-2">Datum do</div><div class="col-2">Cijena (€)</div></div></div>',1),jt={key:2},Dt=t("h1",{class:"text-center"},"Object has no pricelist",-1),kt=[Dt];function wt(s,e,d,h,i,l){const o=v("pricelist_item_card"),I=v("addModal");return a(),r("div",bt,[t("div",gt,[i.object?(a(),r("h3",It,"Cijenik za smještaj "+w(i.object.name),1)):_("",!0),t("div",{class:"btn btn-primary mb-2",onClick:e[0]||(e[0]=(...m)=>l.openAddPricelistModal&&l.openAddPricelistModal(...m))},"Dodaj stavku"),i.pricelistItems.length?(a(),r("div",ft,[yt,(a(!0),r(M,null,$(i.pricelistItems,m=>(a(),p(o,{class:"col-12",item:m,onResetItemData:l.resetItem,onItemDeleted:l.removeItemFromDom},null,8,["item","onResetItemData","onItemDeleted"]))),256))])):(a(),r("div",jt,kt))]),i.object_id?(a(),p(I,{key:0,object_id:i.object_id,onItemAdded:l.addItemToDom,ref:"addModal"},null,8,["object_id","onItemAdded"])):_("",!0)])}const Ft=u(pt,[["render",wt]]);export{Ft as default};
